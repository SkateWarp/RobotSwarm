<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="turtlebot_arena">

  <!-- "world" link to serve as the fixed reference -->
  <link name="world"/>

  <!-- The floor (arena_link) -->
  <link name="arena_link">
    <visual>
      <geometry>
        <!-- 10x10 floor, 0.1 thick -->
        <box size="10 10 0.1"/>
      </geometry>
      <material name="arena_gray">
        <color rgba="0.7 0.7 0.7 1"/>
      </material>
    </visual>
    <collision>
      <geometry>
        <box size="10 10 0.1"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Increased mass to make it very stable -->
      <mass value="1000.0"/>
      <!-- Adjusted inertia for a heavy, stable platform -->
      <inertia ixx="1000.0" ixy="0.0" ixz="0.0" iyy="1000.0" iyz="0.0" izz="1000.0"/>
    </inertial>
    <!-- Add Gazebo-specific tags -->
    <gazebo>
      <static>true</static>
    </gazebo>
  </link>

  <!-- Attach the floor to the world with a fixed joint -->
  <joint name="world_to_arena" type="fixed">
    <parent link="world"/>
    <child link="arena_link"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <!-- ========== Four walls around the floor ========== -->
  <!-- North wall -->
  <link name="arena_wall_north">
    <visual>
      <geometry>
        <!-- 10m wide, 0.2m thick, 1m tall -->
        <box size="10 0.2 1.0"/>
      </geometry>
      <material name="wall_gray">
        <color rgba="0.8 0.8 0.8 1"/>
      </material>
    </visual>
    <collision>
      <geometry>
        <box size="10 0.2 1.0"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="100.0"/>
      <inertia ixx="100.0" ixy="0" ixz="0" iyy="100.0" iyz="0" izz="100.0"/>
    </inertial>
  </link>

  <joint name="joint_arena_north_wall" type="fixed">
    <parent link="arena_link"/>
    <child link="arena_wall_north"/>
    <!-- Shift the north wall up on the Y axis, half the floor dimension + half wall thickness -->
    <origin xyz="0 5.0 0.5" rpy="0 0 0"/>
  </joint>

  <!-- South wall -->
  <link name="arena_wall_south">
    <visual>
      <geometry>
        <box size="10 0.2 1.0"/>
      </geometry>
      <material name="wall_gray"/>
    </visual>
    <collision>
      <geometry>
        <box size="10 0.2 1.0"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="100.0"/>
      <inertia ixx="100.0" ixy="0" ixz="0" iyy="100.0" iyz="0" izz="100.0"/>
    </inertial>
  </link>

  <joint name="joint_arena_south_wall" type="fixed">
    <parent link="arena_link"/>
    <child link="arena_wall_south"/>
    <origin xyz="0 -5.0 0.5" rpy="0 0 0"/>
  </joint>

  <!-- East wall -->
  <link name="arena_wall_east">
    <visual>
      <geometry>
        <box size="0.2 10 1.0"/>
      </geometry>
      <material name="wall_gray"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.2 10 1.0"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="100.0"/>
      <inertia ixx="100.0" ixy="0" ixz="0" iyy="100.0" iyz="0" izz="100.0"/>
    </inertial>
  </link>

  <joint name="joint_arena_east_wall" type="fixed">
    <parent link="arena_link"/>
    <child link="arena_wall_east"/>
    <origin xyz="5.0 0 0.5" rpy="0 0 0"/>
  </joint>

  <!-- West wall -->
  <link name="arena_wall_west">
    <visual>
      <geometry>
        <box size="0.2 10 1.0"/>
      </geometry>
      <material name="wall_gray"/>
    </visual>
    <collision>
      <geometry>
        <box size="0.2 10 1.0"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="100.0"/>
      <inertia ixx="100.0" ixy="0" ixz="0" iyy="100.0" iyz="0" izz="100.0"/>
    </inertial>
  </link>

  <joint name="joint_arena_west_wall" type="fixed">
    <parent link="arena_link"/>
    <child link="arena_wall_west"/>
    <origin xyz="-5.0 0 0.5" rpy="0 0 0"/>
  </joint>

  <!-- ========== Pushable Block (replacing sphere) ========== -->
  <link name="pushable_block">
    <visual>
      <geometry>
        <box size="0.3 0.4 0.15"/>  <!-- Small box that can be pushed by turtlebots -->
      </geometry>
      <material name="object_blue">
        <color rgba="0.3 0.3 1.0 1"/>
      </material>
    </visual>
    <collision>
      <geometry>
        <box size="0.3 0.4 0.15"/>
      </geometry>
    </collision>
    <inertial>
      <!-- Light enough for turtlebots to push -->
      <mass value="0.5"/>
      <inertia ixx="0.01" ixy="0" ixz="0" iyy="0.01" iyz="0" izz="0.01"/>
    </inertial>
  </link>

  <!-- Create a floating joint that allows the block to move freely -->
  <joint name="pushable_block_joint" type="floating">
    <parent link="world"/>
    <child link="pushable_block"/>
    <origin xyz="0 0 0.125" rpy="0 0 0"/>  <!-- Positioned on the floor -->
  </joint>

  <!-- Add Gazebo-specific properties for the pushable block -->
  <gazebo reference="pushable_block">
    <material>Gazebo/Blue</material>
    <mu1>0.1</mu1>  <!-- Low friction coefficient -->
    <mu2>0.1</mu2>
    <kp>1000.0</kp>  <!-- Contact stiffness -->
    <kd>100.0</kd>   <!-- Contact damping -->
  </gazebo>
  
  <!-- ========== Designated Area (Target Zone) ========== -->
  <link name="target_zone">
    <visual>
      <geometry>
        <cylinder radius="0.75" length="0.01"/>  <!-- Circular target zone -->
      </geometry>
      <material name="target_zone_material">
        <color rgba="0.0 1.0 0.0 0.3"/>  <!-- Semi-transparent green -->
      </material>
    </visual>
    <!-- No collision geometry - intangible -->
    <inertial>
      <mass value="0.001"/>  <!-- Nearly massless -->
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>

  <!-- Fixed joint to attach the target zone to the arena -->
  <joint name="target_zone_joint" type="fixed">
    <parent link="arena_link"/>
    <child link="target_zone"/>
    <origin xyz="2 2 0.05" rpy="0 0 0"/>  <!-- Positioned at (2,2) -->
  </joint>

  <!-- Gazebo-specific properties for the target zone -->
  <gazebo reference="target_zone">
    <material>Gazebo/Green</material>
    <transparency>0.7</transparency>  <!-- Make it transparent -->
    <collideBitmask>0x00</collideBitmask>  <!-- Disable collisions -->
  </gazebo>

  <!-- Add Gazebo-specific properties to make the entire model static -->
  <gazebo>
    <static>true</static>
  </gazebo>
</robot>